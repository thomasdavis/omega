# railway.toml - Railway configuration for monorepo deployment
# This file is REQUIRED for multi-service monorepo deployments on Railway

[project]
name = "omega"

###############################################
# SERVICE: omega-bot (Discord bot)
###############################################
[service.omega-bot]
# Use Dockerfile (disables Railpack/Nixpacks auto-detection)
builder = "dockerfile"
dockerfilePath = "apps/bot/Dockerfile"
# Docker build context is repo root

# No ports (background worker)
# Start command is handled by Dockerfile CMD

# Shared persistent volume
mounts = [
  { source = "omega_data", dest = "/data" }
]

###############################################
# SERVICE: omega-web (Next.js web)
###############################################
[service.omega-web]
# Use Dockerfile (disables Railpack/Nixpacks auto-detection)
builder = "dockerfile"
dockerfilePath = "apps/web/Dockerfile"
# Docker build context is repo root

# Public port
port = 3000
# Start command is handled by Dockerfile CMD

# Shared persistent volume (same as omega-bot)
mounts = [
  { source = "omega_data", dest = "/data" }
]

###############################################
# VOLUMES
###############################################
# Shared volume for artifacts, uploads, blog, and SQLite database
[volume.omega_data]
